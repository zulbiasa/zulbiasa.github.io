<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Happy Birthday Iqa</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    background: radial-gradient(circle at center, #02010a 0%, #000 100%);
    font-family: "Poppins", sans-serif;
  }
  canvas {
    display: block;
    width: 100vw;
    height: 100vh;
  }
  /* üéõÔ∏è Top-right container */
#topRight {
  position: fixed;
  top: 10px;
  right: 15px;
  z-index: 1000;
  display: flex;
  gap: 10px;
  font-size: 28px;
}

/* üì® Buttons and icons */
#topRight button,
#topRight a {
  position: relative;
  background: rgba(255, 255, 255, 0.15);
  border: none;
  padding: 8px 12px;
  border-radius: 12px;
  color: white;
  text-decoration: none;
  cursor: pointer;
  backdrop-filter: blur(5px);
  transition: 0.3s ease;
}

#topRight button:hover,
#topRight a:hover {
  background: rgba(255, 255, 255, 0.35);
  transform: scale(1.1);
}

/* üî¥ Notification badge */
#mailIcon .badge {
  position: absolute;
  top: 3px;
  right: 4px;
  background-color: red;
  color: white;
  font-size: 12px;
  font-weight: bold;
  padding: 2px 5px;
  border-radius: 50%;
  animation: pulse 1.5s infinite;
}

/* ‚ú® Smooth pulsing effect for the badge */
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.3); opacity: 0.7; }
}
</style>
</head>
<body>
  <!-- üîä Mute & Message Buttons -->
  <div id="topRight">
    <button id="muteBtn" title="Mute/Unmute">üîä</button>
    <a href="iqa_wish.html" id="mailIcon" title="Open Birthday Wish">
      ‚úâÔ∏è
      <span class="badge">1</span>
    </a>
  </div>
  

  <!-- üé∂ Background Music -->
  <audio id="bgMusic" autoplay loop>
    <source src="/assets/audio/birthday_song.mp3" type="audio/mpeg">
  </audio>

  <canvas id="birthdayCanvas"></canvas>
  </body>

  <script>
    const audio = document.getElementById("bgMusic");
    const muteBtn = document.getElementById("muteBtn");

    muteBtn.addEventListener("click", () => {
      audio.muted = !audio.muted;
      muteBtn.textContent = audio.muted ? "üîá" : "üîä";
    });

    // ===== Your Existing JS Below =====
    const canvas = document.getElementById('birthdayCanvas');
    const ctx = canvas.getContext('2d');
    
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);
    
    const messages = [
      "Happy Birthday", "Feliz Cumplea√±os", "Selamat Hari Lahir", "Joyeux Anniversaire",
      "Alles Gute", "Buon Compleanno", "„ÅäË™ïÁîüÊó•„Åä„ÇÅ„Åß„Å®„ÅÜ", "ÏÉùÏùº Ï∂ïÌïòÌï¥Ïöî",
      "ÁîüÊó•Âø´‰πê", "–° –î–Ω—ë–º –†–æ–∂–¥–µ–Ω–∏—è", "ÿπŸäÿØ ŸÖŸäŸÑÿßÿØ ÿ≥ÿπŸäÿØ", "ŒßœÅœåŒΩŒπŒ± Œ†ŒøŒªŒªŒ¨",
      "Feliz Anivers√°rio", "‡§∂‡•Å‡§≠ ‡§ú‡§®‡•ç‡§Æ‡§¶‡§ø‡§®", "‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î", "Tanti Auguri",
      "üéÇ", "üéà", "üéâ", "ü•≥", "üíñ", "üíê", "üå∏", "üéÅ", "‚ú®", "üç∞", "‚ù§Ô∏è", "üåü", "üé∂", "üíù", "ü©∑"
    ];

    const totalImages = 29;
    const imageSources = Array.from({ length: totalImages }, (_, i) => `/assets/images/iqa/${i + 1}.jpg`);
    const images = [];
    let loaded = 0;
    imageSources.forEach(src => {
      const img = new Image();
      img.src = src;
      img.onload = () => {
        loaded++;
        if (loaded === imageSources.length) startAnimation();
      };
      images.push(img);
    });

    class Star {
      constructor() { this.reset(); }
      reset() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.z = Math.random() * canvas.width;
      }
      update() {
        this.z -= 1.2;
        if (this.z <= 0) this.reset();
      }
      draw() {
        const sx = (this.x - canvas.width / 2) * (canvas.width / this.z) + canvas.width / 2;
        const sy = (this.y - canvas.height / 2) * (canvas.width / this.z) + canvas.height / 2;
        const size = (1 - this.z / canvas.width) * 2;
        ctx.beginPath();
        ctx.arc(sx, sy, size, 0, 2 * Math.PI);
        ctx.fillStyle = "white";
        ctx.fill();
      }
    }

    function createTextCanvas(text, fontSize = 24) {
      const off = document.createElement("canvas");
      const ctx2 = off.getContext("2d");
      ctx2.font = `${fontSize}px Poppins`;
      const w = ctx2.measureText(text).width + 10;
      const h = fontSize + 10;
      off.width = w;
      off.height = h;
      ctx2.font = `${fontSize}px Poppins`;
      ctx2.fillStyle = "white";
      ctx2.textBaseline = "top";
      ctx2.fillText(text, 5, 5);
      return off;
    }

    function startAnimation() {
      const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
      class Word {
        constructor(text) { this.text = text; this.reset(); }
        reset() {
          const range = isMobile ? 0.5 : 2;
          this.x = (Math.random() - 0.5) * canvas.width * range;
          this.y = (Math.random() - 0.5) * canvas.height * range;
          this.z = Math.random() * canvas.width;
        }
        update() {
          this.z -= isMobile ? 1.2 : 2;
          if (this.z < 1) this.reset();
        }
        draw() {
          const sx = (this.x / this.z) * canvas.width + canvas.width / 2;
          const sy = (this.y / this.z) * canvas.height + canvas.height / 2;
          const scale = canvas.width / this.z;
          const size = Math.min(Math.max(scale * 10, 12), 40);
          if (!this.img) this.img = createTextCanvas(this.text, size);
          ctx.globalAlpha = 1 - this.z / canvas.width;
          ctx.drawImage(this.img, sx, sy);
          ctx.globalAlpha = 1;
        }
      }

      class FlyingImage {
        constructor(img) { this.img = img; this.reset(); }
        reset() {
          const range = isMobile ? 0.6 : 2;
          this.x = (Math.random() - 0.5) * canvas.width * range;
          this.y = (Math.random() - 0.5) * canvas.height * range;
          this.z = Math.random() * canvas.width;
          this.size = 30 + Math.random() * 40;
        }
        update() {
          this.z -= isMobile ? 1.5 : 2;
          if (this.z < 1) this.reset();
        }
        draw() {
          const sx = (this.x / this.z) * canvas.width + canvas.width / 2;
          const sy = (this.y / this.z) * canvas.height + canvas.height / 2;
          const scale = canvas.width / this.z;
          const size = this.size * scale;
          ctx.globalAlpha = 1 - this.z / canvas.width;
          ctx.drawImage(this.img, sx - size / 2, sy - size / 2, size, size);
          ctx.globalAlpha = 1;
        }
      }

      let stars, words, flyingImages;
      if (isMobile) {
        stars = Array.from({ length: 40 }, () => new Star());
        words = Array.from({ length: 8 }, () => new Word(messages[Math.floor(Math.random() * messages.length)]));
        flyingImages = Array.from({ length: 10 }, () => new FlyingImage(images[Math.floor(Math.random() * images.length)]));
      } else {
        stars = Array.from({ length: 150 }, () => new Star());
        words = Array.from({ length: 60 }, () => new Word(messages[Math.floor(Math.random() * messages.length)]));
        flyingImages = Array.from({ length: 80 }, () => new FlyingImage(images[Math.floor(Math.random() * images.length)]));
      }

      function animate() {
        ctx.fillStyle = "rgba(0,0,0,0.3)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        stars.forEach(s => { s.update(); s.draw(); });
        words.forEach(w => { w.update(); w.draw(); });
        flyingImages.forEach(i => { i.update(); i.draw(); });

        requestAnimationFrame(animate);
      }

      animate();
    }
  </script>